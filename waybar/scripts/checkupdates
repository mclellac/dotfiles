#!/bin/bash

if ! command -v notify-send &>/dev/null; then
	echo "notify-send is not available. Install libnotify-bin package." >&2
	exit 1
fi

if ! sudo dnf makecache &>/dev/null; then
	echo "Failed to refresh package repositories." >&2
	exit 1
fi

if ! update_output=$(sudo dnf check-update); then
	echo "Failed to check for updates." >&2
	exit 1
fi

update_count=$(echo "$update_output" | grep -c 'updates')
if [ "$update_count" -gt 0 ]; then
	update_list=$(echo "$update_output" | awk '{print $1}' | tail -n +2)
	update_list_formatted=$(echo "$update_list" | paste -sd "," -)

	# Notify user about available updates
	notify-send "${update_count} updates available: ${update_list_formatted}"
fi
